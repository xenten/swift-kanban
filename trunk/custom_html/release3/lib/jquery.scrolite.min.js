/* jQuery Scrolite Plugin v0.1 alpha @author Taha PAKSU (http://www.tahapaksu.com/)*/(function(a){function d(a){a.attr("unselectable","on").addClass("unselectable")}function e(a){a.attr("unselectable",null).removeClass("unselectable")}function f(b,c,d){var e=b.scrollHeight-a(b).height(),f=parseInt(e*c/d);b.scrollTop=f}function g(a){a=a||window.event,a.preventDefault&&a.preventDefault(),a.returnValue=!1}var b={wrapper:".scrolite",scrollbed:".scrolite-bed",scrollbar:".scrolite-bar",container:".scrolite-container",mY:"maxY",sO:"scrollElement"},c=function(c,h){var i=a(c),j=this,k={},l={barColor:"rgba(128,128,128,0.7)",bedColor:"rgba(128,128,128,0.5)",bedWidth:10,bedCornerRadius:5,barWidth:6,barCornerRadius:3,width:"auto",height:"auto",sensitivity:4,bedMarginLeft:5,bedMarginRight:5,bedMarginTop:5,bedMarginBottom:5};console.log("p"+h.sensitivity);var m=jQuery.extend(l,h?h:{});j.config=m;var n=function(){i.wrap("<div class='"+b.wrapper.replace(".","")+"' style='padding:0px;margin:0px;position:relative;display:inline-block;width:"+(m.width!="auto"?m.width:i.width())+"px;height:"+m.height+"px;overflow:hidden;'></div>"),k.scrolite=i.closest(b.wrapper),i.wrap("<div class='"+b.container.replace(".","")+"' style='float:left;padding:0px;margin:0px;position:relative;display:inline-block;width:"+((m.width!="auto"?m.width:i.width())-m.bedWidth-m.bedMarginLeft-m.bedMarginRight)+"px;height:"+m.height+"px;overflow:hidden;'></div>"),k.scrolitecontainer=a(b.container,k.scrolite),k.scrolite.append("<div class='"+b.scrollbed.replace(".","")+"' style='position:absolute;padding:"+(m.bedWidth-m.barWidth)/2+"px;right:0px;top:px;margin:"+m.bedMarginTop+"px "+m.bedMarginRight+"px "+m.bedMarginBottom+"px "+m.bedMarginLeft+"px;background:"+m.bedColor+";width:"+m.barWidth+"px;float:right;border-radius:"+m.bedCornerRadius+"px;'><div class='"+b.scrollbar.replace(".","")+"' style='margin-top:0px;background-color:"+m.barColor+";width:"+m.barWidth+"px;border-radius:"+m.barCornerRadius+"px;'></div></div>"),k.scrolitebed=a(b.scrollbed,k.scrolite),k.scrolitebar=a(b.scrollbar,k.scrolite),k.scrolitebar.data("attached",i),k.scrolitebed.height(k.scrolite.height()-parseInt(k.scrolitebed.css("margin-top"))-parseInt(k.scrolitebed.css("margin-bottom"))-parseInt(k.scrolitebed.css("padding-top"))-parseInt(k.scrolitebed.css("padding-bottom"))),k.scrolitebar.height(k.scrolitebed.innerHeight()-parseInt(k.scrolitebed.css("padding-top"))-parseInt(k.scrolitebed.css("padding-bottom"))),k.scrolitebed.on("contextmenu",function(){return!1}),k.scrolitebed.get(0).onselectstart=function(){return!1}};j.refresh=function(){var a=k.scrolitecontainer.innerHeight(),c=j.scrollHeight?j.scrollHeight:i.height(),d=k.scrolitebed.innerHeight()-(parseInt(k.scrolitebed.css("padding-top"))+parseInt(k.scrolitebed.css("padding-top")));k.scrolitebar.data(b.mY,d);var e=d*a/c;k.scrolitebar.height(e)};var o=function(){i.unbind("mousewheel").bind("mousewheel",function(c,d,e,h){var d=parseInt(h*a(this).data("scrolite").config.sensitivity);console.log(d+"-"+m.scrollSensitivity+"-"+a(this).data("scrolite").config.sensitivity);var i=a(this).parents(b.wrapper).find(b.scrollbar);i&&(parseInt(i.css("margin-top"))-d>=0?parseInt(i.css("margin-top"))-d<=i.data(b.mY)-i.outerHeight()?(i.css("margin-top",parseInt(i.css("margin-top"))-d+"px"),f(i.data("attached").closest(b.container).get(0),parseInt(i.css("margin-top")),i.data(b.mY)-i.outerHeight()),i.data("attached").trigger("scroll"),g(c)):(i.css("margin-top",i.data(b.mY)-i.outerHeight()+"px"),f(i.data("attached").closest(b.container).get(0),i.data(b.mY)-i.outerHeight(),i.data(b.mY)-i.outerHeight()),i.data("attached").trigger("scroll")):(i.css("margin-top","0px"),f(i.data("attached").closest(b.container).get(0),0,i.data(b.mY)-i.outerHeight()),i.data("attached").trigger("scroll")))}),k.scrolitebar.unbind("mousedown").bind("mousedown",function(c){a(document).data(b.sO,a(this)),a(this).data("scrolling",!0),a(this).data("scrollY",c.pageY-parseInt(a(this).css("margin-top"))),d(a(this).data("attached"))}),a(document).unbind("mouseup").bind("mouseup",function(c){var d=a(document).data(b.sO);d&&d.trigger("mouseup")}),k.scrolitebar.unbind("mouseup").bind("mouseup",function(){a(this).data("scrolling",!1),a(this).data("scrollY",null),a(document).data(b.sO,null),e(a(this).data("attached"))}),a(document).unbind("mousemove").bind("mousemove",function(c){var d=a(document).data(b.sO);d&&d.data("scrolling")==1&&d.data("scrollY")-c.pageY<=0&&-(d.data("scrollY")-c.pageY)+d.outerHeight()<=d.data(b.mY)&&(d.css("margin-top",-(d.data("scrollY")-c.pageY)+"px"),f(d.data("attached").closest(b.container).get(0),parseInt(d.css("margin-top")),d.data(b.mY)-d.outerHeight()),d.data("attached").trigger("scroll"))})};n(),j.refresh(),i.load(function(){a(this).data("scrolite").refresh()}),o()};a.fn.scrolite=function(b){return this.each(function(){var d=a(this);if(d.data("scrolite"))return;var e=new c(this,b);d.data("scrolite",e)})}})(jQuery)